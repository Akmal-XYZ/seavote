<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Eagle D’Or 2025 – Voting</title>
<link rel="icon" type="image/png" href="../logo_sea.png" />

<style>
/* =====================
   GLOBAL THEME — BALLON D’OR PREMIUM
   ===================== */
:root {
  --gold: #d4af37;
  --gold-light: #f5d26b;
  --gold-dark: #b18b2c;
  --bg: #0a0a0a;
  --glass: rgba(255,255,255,0.05);
  --border-glass: rgba(255,255,255,0.1);
  --shadow-gold: 0 0 25px rgba(212,175,55,0.6);
  --shadow-soft: 0 0 15px rgba(212,175,55,0.35);
  --font-primary: "Montserrat", sans-serif;
}

body {
  margin:0;
  background: var(--bg);
  font-family: var(--font-primary);
  color:white;
  overflow-x:hidden;
}

/* =====================
   LUXURY TOP HEADER
   ===================== */
header {
  width:100%;
  padding:40px 0 20px 0;
  text-align:center;
  background:linear-gradient(to bottom, #000, transparent);
}

header img.logo-eagle {
  width:120px;
  animation:fadeIn 1.6s ease;
}

header h1 {
  font-size:2.3rem;
  letter-spacing:2px;
  margin-top:12px;
  color:var(--gold-light);
  text-shadow:var(--shadow-soft);
  animation: slideDown 1s ease-out;
}

@keyframes fadeIn {
  from {opacity:0;}
  to {opacity:1;}
}

@keyframes slideDown {
  from {transform:translateY(-30px);opacity:0;}
  to {transform:translateY(0);opacity:1;}
}

/* =====================
   GRID CARD PLAYER
   ===================== */
.players {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap:25px;
  padding:40px;
  max-width:1300px;
  margin:auto;
}

.player-card {
  background:var(--glass);
  border:1px solid var(--border-glass);
  border-radius:18px;
  padding:15px;
  backdrop-filter: blur(7px);
  box-shadow: 0 0 25px rgba(212,175,55,0.15);
  transition:0.35s;
  position:relative;
}

.player-card:hover {
  transform:translateY(-8px);
  box-shadow: var(--shadow-gold);
}

.player-card img {
  width:100%;
  border-radius:12px;
}

.player-name {
  font-size:1.3rem;
  font-weight:700;
  color:var(--gold-light);
  margin-top:12px;
}

.player-circle {
  font-size:0.9rem;
  color:#aaa;
  margin-bottom:10px;
}

/* =====================
   VOTE BUTTON
   ===================== */
.vote-btn {
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:linear-gradient(90deg, var(--gold-dark), var(--gold-light));
  color:#000;
  font-weight:700;
  margin-top:10px;
  cursor:pointer;
  font-size:1.1rem;
  transition:0.3s;
}

.vote-btn:hover {
  filter:brightness(1.15);
}

/* =====================
   SPONSORS
   ===================== */
.sponsors-title {
  text-align:center;
  margin-top:40px;
  font-size:1.5rem;
  color:var(--gold-light);
  text-shadow:var(--shadow-soft);
}

.sponsors {
  display:flex;
  flex-wrap:wrap;
  gap:25px;
  justify-content:center;
  padding:20px;
}

.sponsors img {
  width:110px;
  opacity:0.8;
  transition:0.3s;
}

.sponsors img:hover {
  opacity:1;
}

/* =====================
   OVERLAY VOTING FORM
   ===================== */
.overlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.65);
  backdrop-filter:blur(8px);
  display:none;
  justify-content:center;
  align-items:center;
  z-index:99;
}

.overlay-box {
  width:90%;
  max-width:420px;
  background:var(--glass);
  padding:25px;
  border-radius:15px;
  border:1px solid var(--border-glass);
  box-shadow:var(--shadow-gold);
  animation:popup 0.4s ease;
}

@keyframes popup {
  from {transform:scale(0.7);opacity:0;}
  to {transform:scale(1);opacity:1;}
}

.overlay-box h2 {
  text-align:center;
  margin-bottom:15px;
  color:var(--gold-light);
}

input, select {
  width:100%;
  padding:12px;
  background:#111;
  border:1px solid #222;
  border-radius:8px;
  color:white;
  margin-bottom:12px;
}

.submit-btn {
  width:100%;
  padding:12px;
  background:var(--gold-light);
  border:none;
  border-radius:8px;
  color:#000;
  font-weight:700;
  cursor:pointer;
}

.close-overlay {
  margin-top:10px;
  width:100%;
  text-align:center;
  color:#bbb;
  cursor:pointer;
}
</style>


</head>
<body>

<!-- ========== HEADER ========== -->
<header>
  <img src="/logo_eagledor.png" alt="Eagle D'Or Logo" class="logo-eagle">
  <h1>Eagle D’Or 2025</h1>
  <div style="color:#bdbdbd;margin-top:6px;font-size:14px">SEA — SAMP E-Sports Association News</div>
</header>

<!-- ========== PLAYERS GRID ========== -->
<section class="players" id="players">
  <!-- Player cards generated statically here (you can also let JS inject) -->
  <article class="player-card" data-id="billy">
    <div class="player-image">
      <img src="/billycostercard.png" alt="Billy Coster">
    </div>
    <div class="player-name">Billy Coster</div>
    <div class="player-circle">Indonesia</div>
    <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="flex:1">
        <div style="font-size:12px;color:#bdbdbd">Suara</div>
        <div id="count-billy" style="font-weight:700;color:var(--gold-light);font-size:18px">0</div>
      </div>
      <div style="width:140px">
        <button class="vote-btn" data-id="billy">Vote</button>
      </div>
    </div>
  </article>

  <article class="player-card" data-id="youngky">
    <div class="player-image">
      <img src="/youngkycard.png" alt="Youngky">
    </div>
    <div class="player-name">Youngky</div>
    <div class="player-circle">IMP</div>
    <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="flex:1">
        <div style="font-size:12px;color:#bdbdbd">Suara</div>
        <div id="count-youngky" style="font-weight:700;color:var(--gold-light);font-size:18px">0</div>
      </div>
      <div style="width:140px">
        <button class="vote-btn" data-id="youngky">Vote</button>
      </div>
    </div>
  </article>

  <article class="player-card" data-id="guzman">
    <div class="player-image">
      <img src="/guzmancard.png" alt="Guzman">
    </div>
    <div class="player-name">Guzman</div>
    <div class="player-circle">Tongsetan</div>
    <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="flex:1">
        <div style="font-size:12px;color:#bdbdbd">Suara</div>
        <div id="count-guzman" style="font-weight:700;color:var(--gold-light);font-size:18px">0</div>
      </div>
      <div style="width:140px">
        <button class="vote-btn" data-id="guzman">Vote</button>
      </div>
    </div>
  </article>

  <article class="player-card" data-id="gonzela">
    <div class="player-image">
      <img src="/gonzelcard.jpg" alt="Gonzela">
    </div>
    <div class="player-name">Gonzela</div>
    <div class="player-circle">Tongsetan</div>
    <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="flex:1">
        <div style="font-size:12px;color:#bdbdbd">Suara</div>
        <div id="count-gonzela" style="font-weight:700;color:var(--gold-light);font-size:18px">0</div>
      </div>
      <div style="width:140px">
        <button class="vote-btn" data-id="gonzela">Vote</button>
      </div>
    </div>
  </article>

  <article class="player-card" data-id="revan">
    <div class="player-image">
      <img src="../rvncard.png" alt="Revan">
    </div>
    <div class="player-name">Revan</div>
    <div class="player-circle">Sector Nine</div>
    <div style="display:flex;gap:12px;margin-top:8px;align-items:center">
      <div style="flex:1">
        <div style="font-size:12px;color:#bdbdbd">Suara</div>
        <div id="count-revan" style="font-weight:700;color:var(--gold-light);font-size:18px">0</div>
      </div>
      <div style="width:140px">
        <button class="vote-btn" data-id="revan">Vote</button>
      </div>
    </div>
  </article>

</section>

<!-- ========== SPONSORS ========== -->
<section>
  <div class="sponsors-title">Official Sponsors</div>
  <div class="sponsors" aria-hidden="false">
    <img src="../grentalcityaponsor.png" alt="sponsor">
    <img src="../holevinesponsor.png" alt="sponsor">
    <img src="../nationhopesponsor.png" alt="sponsor">
    <img src="../relativesponsor.png" alt="sponsor">
    <img src="../zynestrasponsor.png" alt="sponsor">
  </div>
</section>

<!-- ========== OVERLAY VOTE FORM ========== -->
<div class="overlay" id="overlay">
  <div class="overlay-box" role="dialog" aria-modal="true">
    <h2>Konfirmasi Suara</h2>

    <div style="font-size:13px;color:#ccc;margin-bottom:8px">Nominee: <span id="ov-nominee" style="font-weight:700;color:var(--gold-light)"></span></div>

    <label for="icName" style="display:block;color:#bdbdbd;margin-bottom:6px">NAMA IC KAMU</label>
    <input id="icName" type="text" placeholder="Nama in-game (contoh: Akmal_Shellby)">

    <label for="icOrigin" style="display:block;color:#bdbdbd;margin-bottom:6px">Asal Kota IC Kamu</label>
    <input id="icOrigin" type="text" placeholder="Contoh: Crystal Pride Roleplay">

    <label for="oocCity" style="display:block;color:#bdbdbd;margin-bottom:6px">Asal Kota OOC Kamu</label>
    <select id="oocCity">
  <option>Aceh</option>
  <option>Sumatera Utara</option>
  <option>Sumatera Barat</option>
  <option>Riau</option>
  <option>Kepulauan Riau</option>
  <option>Jambi</option>
  <option>Bengkulu</option>
  <option>Sumatera Selatan</option>
  <option>Kepulauan Bangka Belitung</option>
  <option>Lampung</option>
  <option>Banten</option>
  <option>DKI Jakarta</option>
  <option>Jawa Barat</option>
  <option>Jawa Tengah</option>
  <option>DI Yogyakarta</option>
  <option>Jawa Timur</option>
  <option>Bali</option>
  <option>Nusa Tenggara Barat</option>
  <option>Nusa Tenggara Timur</option>
  <option>Kalimantan Barat</option>
  <option>Kalimantan Tengah</option>
  <option>Kalimantan Selatan</option>
  <option>Kalimantan Timur</option>
  <option>Kalimantan Utara</option>
  <option>Sulawesi Utara</option>
  <option>Sulawesi Tengah</option>
  <option>Sulawesi Selatan</option>
  <option>Sulawesi Tenggara</option>
  <option>Gorontalo</option>
  <option>Maluku</option>
  <option>Maluku Utara</option>
  <option>Papua</option>
  <option>Papua Barat</option>
  <option>Papua Tengah</option>
  <option>Papua Pegunungan</option>
  <option>Papua Selatan</option>
  <option>Papua Barat Daya</option>
</select>

    <button class="submit-btn" id="submitVote">Kirim Suara</button>
    <div class="close-overlay" id="closeOverlay">Batal</div>
    <div style="font-size:12px;color:#aaa;margin-top:8px">Catatan: 1 browser hanya dapat memberikan 1 suara untuk tiap nominee.</div>
  </div>
</div>


  <div id="adminArea" style="display:none;margin-top:12px">
    <div style="font-size:13px;color:#bdbdbd">Adjustment (tambah / kurang)</div>
    <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:8px" id="adjustInputs">
      <!-- inputs generated by JS -->
    </div>
    <button id="saveAdjust" style="margin-top:10px;width:100%;padding:10px;border-radius:8px;border:none;background:var(--gold-light);color:#000;font-weight:700;cursor:pointer">Simpan</button>
  </div>
</div>

<!-- ========== FOOTER ========== -->
<footer style="text-align:center;padding:30px 12px;color:#bdbdbd">
  © 2025 SEA — SAMP E-Sports Association News — Eagle D’Or
</footer>


<!-- ========== MATERIAL SYMBOLS PLAY ICON ========== -->
<link rel="stylesheet"
href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,400..700,0..1,-50..200&icon_names=play_arrow" />

<style>
.material-symbols-outlined {
  font-variation-settings:
    "FILL" 0,
    "wght" 600,
    "GRAD" 0,
    "opsz" 32;
}

/* ===== FUTURISTIC PLAY ICON BUTTON (GOLD GLASS CARD) ===== */
.play-btn {
  width: 45px;
  height: 45px;
  border-radius: 12px;
  background: linear-gradient(145deg, var(--gold-dark), var(--gold-light));
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
  transition:0.25s ease;

  box-shadow:0 0 14px rgba(212,175,55,0.35);
}

.play-btn:hover {

  transform:translateY(-4px) scale(1.05);
  box-shadow:0 0 22px rgba(212,175,55,0.55);
}

.play-btn span {

  font-size:28px;
  color:#000;
}

/* responsive */
@media (max-width:480px){
  .play-btn {

    width:40px;
    height:40px;
    border-radius:10px;
  }
  .play-btn span { font-size:24px; }
}
</style>

<script>
// ========== LINK TIKTOK ========== //
const gameplayLinks = {
  billy:   "https://www.tiktok.com/@sampesports/video/7575809030975687944",
  youngky: "https://www.tiktok.com/@sampesports/video/7575810655614225672",
  guzman:  "https://www.tiktok.com/@sampesports/video/7575814624013028615",
  gonzela: "https://www.tiktok.com/@sampesports/video/7575813453437340946",
  revan:   "https://www.tiktok.com/@sampesports/video/7575812066913570055"
};

// ========== INJECT PLAY ICON DI ATAS TOMBOL VOTE ========== //
document.querySelectorAll(".player-card").forEach(card => {
  const id = card.dataset.id;
  if (!id || !gameplayLinks[id]) return;

  const voteBtn = card.querySelector(".vote-btn");

  const play = document.createElement("a");
  play.href = gameplayLinks[id];
  play.target = "_blank";
  play.className = "play-btn";
  play.innerHTML = `<span class="material-symbols-outlined">play_arrow</span>`;

  // TEMPATKAN DI ATAS TOMBOL VOTE
  voteBtn.parentElement.parentElement.insertBefore(play, voteBtn.parentElement);
});
</script>

</body>
</html>

<script>

/*************************************************
 *  FIREBASE SETUP
 *************************************************/
const firebaseURL = "https://akun-f6c0e-default-rtdb.firebaseio.com/votes";
const voteLogURL = "https://akun-f6c0e-default-rtdb.firebaseio.com/vote_logs";
const nominees = ["billy", "youngky", "guzman", "gonzela", "revan"];

/*************************************************
 *  VOTE DATA (ASLI DARI FIREBASE)
 *************************************************/
let voteData = {
  billy: 0,
  youngky: 0,
  guzman: 0,
  gonzela: 0,
  revan: 0
};

/*************************************************
 *  SCRIPT ADJUSTMENT — LU EDIT MANUAL DI SINI
 *************************************************/
let scriptAdjustment = {
  billy: 0,
  youngky: 0,
  guzman: 0,
  gonzela: 0,
  revan: 0
};

/*************************************************
 *  ADMIN ADJUSTMENT — DARI PANEL ADMIN
 *************************************************/
let adminAdjustment = {
  billy: 0,
  youngky: 0,
  guzman: 0,
  gonzela: 0,
  revan: 0
};

/*************************************************
 *  HITUNG TOTAL SUARA
 *************************************************/
function getTotalVotes(id) {
  return Math.max(
    0,
    (voteData[id] || 0) +
    (scriptAdjustment[id] || 0) +
    (adminAdjustment[id] || 0)
  );
}

/*************************************************
 *  UPDATE UI
 *************************************************/
function updateVoteUI() {
  nominees.forEach(id => {
    const el = document.getElementById(`count-${id}`);
    if (el) el.textContent = getTotalVotes(id);
  });
}

/*************************************************
 *  LOAD DATA DARI FIREBASE
 *************************************************/
async function loadVotes() {
  try {
    const res = await fetch(`${firebaseURL}.json`);
    const data = await res.json();
    if (data) voteData = data;
    updateVoteUI();
  } catch {
    console.error("Gagal load Firebase");
  }
}

loadVotes();

/*************************************************
 *  SIMPAN DATA KE FIREBASE (INAL + SCRIPT + ADMIN)
 *************************************************/
async function saveVotes() {
  let merged = {};

  nominees.forEach(id => {
    merged[id] = getTotalVotes(id);
  });

  await fetch(`${firebaseURL}.json`, {
    method: "PUT",
    body: JSON.stringify(merged)
  });

  voteData = merged;
  updateVoteUI();
}

/*************************************************
 *  OVERLAY VOTING
 *************************************************/
const overlay = document.getElementById("overlay");
const ovNominee = document.getElementById("ov-nominee");
let currentVoteID = null;

document.querySelectorAll(".vote-btn").forEach(btn => {
  btn.onclick = () => {
    currentVoteID = btn.dataset.id;
    ovNominee.textContent = capitalize(currentVoteID);
    overlay.style.display = "flex";
  };
});

document.getElementById("closeOverlay").onclick = () => {
  overlay.style.display = "none";
};

/*************************************************
 *  SUBMIT VOTE (HANYA VOTE ASLI YG NAIK)
 *************************************************/
document.getElementById("submitVote").onclick = async () => {
  const ic = document.getElementById("icName").value.trim();
  const oriIC = document.getElementById("icOrigin").value.trim();
  const ooc = document.getElementById("oocCity").value;

  if (!ic || !oriIC || !ooc) {
    alert("Semua data harus diisi.");
    return;
  }

  const key = `voted_${currentVoteID}`;
  if (localStorage.getItem(key)) {
    alert("Kamu sudah vote nominee ini.");
    return;
  }

  voteData[currentVoteID] += 1;

  // Kirim log identitas ke database
  try {
    await fetch(`${voteLogURL}/${currentVoteID}.json`, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({
        icName: ic,
        icOrigin: oriIC,
        oocCity: ooc,
        timestamp: Date.now()
      })
    });
  } catch(e) {
    // tetap lanjut walau gagal log
    console.warn("Gagal log identitas vote", e);
  }

  await saveVotes();
  localStorage.setItem(key, "true");

  overlay.style.display = "none";
  alert("Terima kasih, suara berhasil dikirim!");
};

/*************************************************
 *  ADMIN PANEL
 *************************************************/
const adminBtn = document.getElementById("adminBtn");
const adminPanel = document.getElementById("adminPanel");
const adminUnlock = document.getElementById("adminUnlock");
const adminArea = document.getElementById("adminArea");
const adjustInputs = document.getElementById("adjustInputs");

adminBtn.onclick = () => {
  adminPanel.style.display = adminPanel.style.display === "none" ? "block" : "none";
};

adminUnlock.onclick = () => {
  const pass = document.getElementById("adminPassword").value;
  if (pass !== "sea2025") {
    alert("Password salah.");
    return;
  }

  adminArea.style.display = "block";
  generateAdminAdjust();
};

function generateAdminAdjust() {
  adjustInputs.innerHTML = "";

  nominees.forEach(id => {
    adjustInputs.innerHTML += `
      <div>
        <div style="font-size:12px;color:#ccc">${capitalize(id)}</div>
        <input type="number" id="admin-adj-${id}" value="0" style="margin-top:4px;background:#111;color:#fff;border:1px solid #333;border-radius:6px;padding:6px">
      </div>
    `;
  });
}

document.getElementById("saveAdjust").onclick = async () => {
  nominees.forEach(id => {
    let val = parseInt(document.getElementById(`admin-adj-${id}`).value);
    if (isNaN(val)) val = 0;
    adminAdjustment[id] += val;
  });

  await saveVotes();
  alert("Adjustment berhasil disimpan.");
};

/*************************************************
 *  UTIL
 *************************************************/
function capitalize(str) {
  return str.charAt(0).toUpperCase() + str.slice(1);
}

/*************************************************
 *  AUTO REFRESH (REALTIME SINKRON)
 *************************************************/
setInterval(loadVotes, 5000);
</script>


<!-- ========== BAGIAN 4: ANIMASI + MOBILE POLISH ========== -->
<style>
/* Extra micro-styles for premium finish */
.player-card .player-image {border-radius:12px;overflow:hidden;background:linear-gradient(180deg,#050505,#0b0b0b);display:block;}
.player-card .player-image img{display:block;width:100%;height:100%;object-fit:cover;transform:scale(1);transition:transform .7s cubic-bezier(.2,.8,.2,1);}

.player-card:hover .player-image img{transform:scale(1.04);}

/* small glow under name */
.player-name {position:relative}
.player-name::after{
  content:"";
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  bottom:-8px;
  width:60%;
  height:6px;
  background:linear-gradient(90deg, rgba(212,175,55,0.12), rgba(212,175,55,0.25));
  border-radius:6px;
  filter: blur(6px);
  opacity:0.9;
}

/* responsive tweaks for overlay on small screens */
@media (max-width:520px){
  .overlay-box { max-width: 95%; padding:16px; }
  header h1 { font-size:1.6rem; }
  .players { padding:18px 12px; gap:14px; }
  .player-name { font-size:1.05rem; }
  .player-card { padding:12px; border-radius:12px; }
  .sponsors img { width:84px; }
}

/* spinner for submit button */
.btn-loading {
  position:relative;
  pointer-events:none;
  opacity:0.85;
}
.btn-loading::after {
  content:"";
  position:absolute;
  right:12px;
  top:50%;
  transform:translateY(-50%);
  width:14px;
  height:14px;
  border-radius:50%;
  border:2px solid rgba(0,0,0,0.12);
  border-top-color: #111;
  animation:spin .9s linear infinite;
}
@keyframes spin {to { transform: rotate(360deg); }}

/* subtle page enter animation */
body.fade-ready { opacity: 0; transform: translateY(6px); transition: all .45s ease; }
body.fade-ready.ready { opacity: 1; transform: translateY(0); }

/* small accessible focus ring for keyboard users */
.vote-btn:focus, .submit-btn:focus, #adminUnlock:focus, #adminBtn:focus {
  outline: 3px solid rgba(212,175,55,0.18);
  outline-offset: 3px;
  border-radius:8px;
}
</style>

<script>
/* ========== Extra JS polish ========== */

/* page entrance */
document.documentElement.style.scrollBehavior = 'smooth';
document.body.classList.add('fade-ready');
window.addEventListener('load', ()=> setTimeout(()=> document.body.classList.add('ready'), 60));

/* debounce helper */
function debounce(fn, t){ let timeout; return (...a)=>{ clearTimeout(timeout); timeout = setTimeout(()=>fn.apply(this,a), t); }; }

/* ensure overlay inputs submit via Enter key */
const icInput = document.getElementById('icName');
const icOrigin = document.getElementById('icOrigin');
const oocSelect = document.getElementById('oocCity');
[icInput, icOrigin, oocSelect].forEach(el=>{
  if(!el) return;
  el.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter'){
      e.preventDefault();
      document.getElementById('submitVote').click();
    }
  });
});

/* submit button UX: show loading for short period & disable double click (debounced) */
const submitBtn = document.getElementById('submitVote');
let submitting = false;
const originalSubmitText = submitBtn.textContent;

submitBtn.addEventListener('click', debounce(async ()=>{
  if (submitting) return;
  submitting = true;
  submitBtn.classList.add('btn-loading');
  submitBtn.textContent = 'Mengirim...';

  // reuse existing click handler defined in Bagian 3
  try {
    // call the existing handler by dispatching click event (works because handler attached)
    // but to preserve async/await flow, we call the function directly if exists
    // existing handler is attached to element's onclick — so trigger it:
    const ev = new MouseEvent('click');
    // we need to temporarily remove loading after existing handler completes, but we don't have its promise.
    // So, poll for overlay hidden state as finish signal (overlay hidden after submit)
    document.getElementById('submitVote').dispatchEvent(ev);

    const waitForClose = new Promise((resolve)=>{
      const check = setInterval(()=>{
        const ov = document.getElementById('overlay');
        if (!ov || ov.style.display === 'none' || ov.classList.contains('hidden')) {
          clearInterval(check);
          resolve();
        }
      }, 250);
      // safety timeout
      setTimeout(()=>{ clearInterval(check); resolve(); }, 5000);
    });

    await waitForClose;
  } catch(e){ console.error(e); }
  // restore
  submitBtn.classList.remove('btn-loading');
  submitBtn.textContent = originalSubmitText;
  submitting = false;
}, 300));

/* Accessibility: close overlay on Esc */
document.addEventListener('keydown', (e)=>{
  if (e.key === 'Escape') {
    const ov = document.getElementById('overlay');
    if (ov) ov.style.display = 'none';
  }
});

/* improve mobile images loading: add decoding & fetchpriority attributes where possible */
document.querySelectorAll('.player-card img, .sponsors img, header img.logo-eagle').forEach(img=>{
  try{
    img.setAttribute('decoding','async');
    img.setAttribute('loading','lazy');
    img.setAttribute('fetchpriority','low');
  }catch(e){}
});

/* enforce no horizontal scroll on tiny devices */
function fixViewportOverflow(){
  const body = document.body;
  setTimeout(()=> {
    const w = document.documentElement.clientWidth;
    if (w < 400) {
      body.style.fontSize = '15px';
    } else {
      body.style.fontSize = '';
    }
  }, 60);
}
window.addEventListener('resize', debounce(fixViewportOverflow, 120));
fixViewportOverflow();

/* smoother image fallback: if image fails, fill with gradient */
document.querySelectorAll('.player-card img').forEach(img=>{
  img.addEventListener('error', ()=>{
    const parent = img.closest('.player-image') || img.parentElement;
    if(parent){
      parent.style.background = 'linear-gradient(135deg,#0b0b0b,#111 60%, rgba(212,175,55,0.04))';
      img.style.display = 'none';
    }
  });
});

/* Admin UX: focus first input when panel opens */
const adminBtn = document.getElementById('adminBtn');
const adminPanel = document.getElementById('adminPanel');
const adminPwdInput = document.getElementById('adminPassword');
adminBtn.addEventListener('click', ()=> setTimeout(()=> adminPwdInput.focus(), 120));

/* tiny polling improvement: reduce freq on mobile to save bandwidth */
let pollInterval = 5000;
function adaptivePolling(){
  const w = window.innerWidth;
  if (w <= 420) pollInterval = 8000;
  else if (w <= 800) pollInterval = 6000;
  else pollInterval = 5000;
  // restart interval (we assume loadVotes exists)
  if (window._votePoll) clearInterval(window._votePoll);
  window._votePoll = setInterval(()=> { try{ window.loadVotes(); }catch(e){} }, pollInterval);
}
adaptivePolling();
window.addEventListener('resize', debounce(adaptivePolling, 200));

/* Small UX: when clicking outside overlay, close it */
document.getElementById('overlay').addEventListener('click', (e)=>{
  if (e.target === e.currentTarget) document.getElementById('overlay').style.display = 'none';
});

/* final console helper message */
console.info('Eagle D\'Or UI polish loaded — mobile optimizations active.');
</script>


<!-- ========== WATERMARK SEA UNTUK SETIAP CARD ========== -->
<style>
.card-watermark {
top:10%;
  position:absolute;
  bottom:10px;
  right:10px;
  width:75px;
  opacity:0.1;
  pointer-events:none;
  user-select:none;
  filter:drop-shadow(0 0 6px rgba(0,0,0,0.7));
  transition:0.25s;
}

.player-card:hover .card-watermark {
  opacity:0.1;
}
@media(max-width:520px){
  .card-watermark {
    width:58px;
    bottom:8px;
    right:8px;
  }
}
</style>

<script>
// === AUTO TAMBAHKAN WATERMARK KE SEMUA CARD ===
// logo SEA mu (ganti jika beda)
const seaLogo = "../logo_sea.png";

// ambil semua card
document.querySelectorAll(".player-card").forEach(card => {
  // bikin elemen img
  const wm = document.createElement("img");
  wm.src = seaLogo;
  wm.className = "card-watermark";
  // tambahkan ke card
  card.style.position = "relative";
  card.appendChild(wm);
});
</script>


<style>

.play-btn {
  margin-bottom: 12px; /* play icon jadi naik ke atas */
  margin-top: 24px;    /* play icon turun ke bawah */
}
    /* Hilangin efek biru saat klik di seluruh halaman */
    * {
        -webkit-tap-highlight-color: transparent;
        -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    /* Hilangin outline biru saat fokus */
    *:focus {
        outline: none !important;
    }
</style>
